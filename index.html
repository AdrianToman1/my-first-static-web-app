<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
  <title>Vanilla JavaScript App</title>
  <script>
    function slackJsonToText() {
      let slackPosts = JSON.parse(document.getElementById("input").value);
      let htmls = [];

      slackPosts.forEach(element => {
        let html = "<div><div><b>" + element.user_profile?.display_name + "</b></div><div>" + element.text + "</div></div>"; 

        htmls.push(html);
      });

      document.getElementById("output").innerHTML = htmls.join("");
    }

    function copyText() {    
        const el = document.createElement("textarea");
        el.value = document.getElementById("output").innerHTML;
        document.body.appendChild(el);
        el.select();
        document.execCommand("copy");
        document.body.removeChild(el);
   }

   function selectAll() {
    var sel, range;
	var el = document.getElementById("output"); //get element id
	if (window.getSelection && document.createRange) { //Browser compatibility
	  sel = window.getSelection();
	  if(sel.toString() == ''){ //no text selection
		 window.setTimeout(function(){
			range = document.createRange(); //range object
			range.selectNodeContents(el); //sets Range
			sel.removeAllRanges(); //remove all ranges from selection
			sel.addRange(range);//add Range to a Selection.
		},1);
	  }
	}else if (document.selection) { //older ie
		sel = document.selection.createRange();
		if(sel.text == ''){ //no text selection
			range = document.body.createTextRange();//Creates TextRange object
			range.moveToElementText(el);//sets Range
			range.select(); //make selection.
		}
	}}
  </script>
</head>

<body>
  <main>
    <h3>Slack To Text</h3>
    <div style="display: flex;">
      <div style="width: 50%; padding: 10px;"><div>Paste Slack JSON in here</div><div style="padding: 2px;"><textarea id="input" style="width: 100%; min-height: 400px;" oninput="slackJsonToText();"></textarea></div></div>
      <div style="width: 50%; padding: 10px;"><div><button onclick="selectAll();">Select All</button></div><div id="output" style="padding: 2px; border: 1px dashed black; width: 100%; min-height: 400px"></div></div>
    </div>
  </main>
</body>

</html>